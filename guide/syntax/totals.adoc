
[[totals]]
== UBL構文での計算式

以下の要素は、請求書、または、クレジットノートの法定金額の合計を示しています:
[cols="3,5", options="header"]
|===
| 要素
| 計算式

| <cbc:LineExtensionAmount>
| stem:[sum("cac:InvoiceLine/cbc:LineExtensionAmount")]

| <cbc:AllowanceTotalAmount>
| stem:[sum("cac:AllowanceCharge[ChargeIndicator='false'$$]$$/cbc:Amount")]

| <cbc:ChargeTotalAmount>
| stem:[sum("cac:AllowanceCharge[ChargeIndicator='true'$$]$$/cbc:Amount")]

| <cbc:TaxExclusiveAmount>
| stem:[\ \ \ \ "cac:LegalMonetaryTotal/cbc:LineExtensionAmount"] +
stem:[– \ "cac:LegalMonetaryTotal/cbc:AllowanceTotalAmount"] +
stem:[+ \ "cac:LegalMonetaryTotal/cbc:ChargeTotalAmount"]

| <cbc:TaxInclusiveAmount>
| stem:[\ \ \ \ "cac:LegalMonetaryTotal/cbc:TaxExclusiveAmount"] +
stem:[+ \ "cac:TaxTotal/cbc:TaxAmount"]

| <cbc:PrepaidAmount>
| _該当なし_

| <cbc:PayableRoundingAmount>
| _該当なし_

| <cbc:PayableAmount>
| stem:[\ \ \ \ "cac:LegalMonetaryTotal/cbc:TaxInclusiveAmount"] +
stem:[- \ "cac:LegalMonetaryTotal/cbc:PrepaidAmount"] +
stem:[+ \ "cac:LegalMonetaryTotal/cbc:PayableRoundingAmount"]
|===



== 支払い可能丸め込み額（PayableRoundingAmount）の要素

支払い予定額は丸め込むことができます。

要素 `cac:LegalMonetaryTotal/cbc:PayableRoundingAmount` は、この目的のために使用され、ヘッダレベルで指定される。この値は、`cac:LegalMonetaryTotal/cbc:PayableAmount` の値に加算されます。

例:  合計が 999.81 の場合、丸め込むと 1000 になります.  支払い可能丸め込み額は、 0.19 となります。
